<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-lang/cpp/面向对象/结构型模式" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">结构型模式 | Panovista</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://wangenius.github.io/docs/lang/cpp/面向对象/结构型模式"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" property="og:locale:alternate" content="en"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="结构型模式 | Panovista"><meta data-rh="true" name="description" content="适配器模式"><meta data-rh="true" property="og:description" content="适配器模式"><link data-rh="true" rel="icon" href="/img/panovista.svg"><link data-rh="true" rel="canonical" href="https://wangenius.github.io/docs/lang/cpp/面向对象/结构型模式"><link data-rh="true" rel="alternate" href="https://wangenius.github.io/en/docs/lang/cpp/面向对象/结构型模式" hreflang="en"><link data-rh="true" rel="alternate" href="https://wangenius.github.io/docs/lang/cpp/面向对象/结构型模式" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://wangenius.github.io/docs/lang/cpp/面向对象/结构型模式" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Panovista RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Panovista Atom Feed">





<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.44829431.css">
<script src="/assets/js/runtime~main.1e5f8495.js" defer="defer"></script>
<script src="/assets/js/main.bae860c9.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/panovista.png" alt="logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/panovista.png" alt="logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">panovista</b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">DSA</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/dsa/ds/概述">算法和数据结构</a></li><li><a class="dropdown__link" href="/docs/dsa/leetcode/字符串相关/公共字段">leetcode刷题</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">计算机原理</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/cs/co/概述">组成原理</a></li><li><a class="dropdown__link" href="/docs/cs/db/SQL">数据库</a></li><li><a class="dropdown__link" href="/docs/cs/os/概述">操作系统</a></li><li><a class="dropdown__link" href="/docs/cs/web/LAN和以太网">计算机网络</a></li><li><a class="dropdown__link" href="/docs/more/git/安装和设置">Git</a></li><li><a class="dropdown__link" href="/docs/cs/se/概述">软件工程</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">AI</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/ai/ml/概述">机器学习</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">语言</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/lang/cpp/简介">C++</a></li><li><a class="dropdown__link" href="/docs/lang/python/概述">Python</a></li><li><a class="dropdown__link" href="/docs/lang/rust/简介">Rust</a></li><li><a class="dropdown__link" href="/docs/lang/ts/CSS">TypeScript</a></li><li><a class="dropdown__link" href="/docs/lang/compile/概述">编译原理</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">更多</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/more/math/space">数学</a></li><li><a class="dropdown__link" href="/docs/more/tools/scoop">工具和工作流</a></li></ul></div><a class="navbar__item navbar__link" href="/docs/opus/overview">作品集</a><a class="navbar__item navbar__link" href="/blog">博客</a><a class="navbar__item navbar__link" href="/docs/about/关于我">关于</a><a href="https://github.com/wangenius/wangenius.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/"><img src="/img/panovista.png" alt="logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/panovista.png" alt="logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"><b>panovista</b></a><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/lang/cpp/简介">简介</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/lang/cpp/C++风格">C++风格</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">模块和编译</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lang/cpp/模块和编译/编译">编译</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lang/cpp/模块和编译/程序和模块">程序和模块</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">变量和声明</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lang/cpp/变量和声明/变量和常量">变量和常量</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lang/cpp/变量和声明/声明和初始化">声明和初始化</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lang/cpp/变量和声明/数据类型">数据类型</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lang/cpp/变量和声明/指针和引用">指针和引用</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lang/cpp/变量和声明/联合和枚举">联合和枚举</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">表达式和函数</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lang/cpp/表达式和函数/表达式和语句">表达式和语句</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lang/cpp/表达式和函数/函数">函数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lang/cpp/表达式和函数/基本操作">基本操作</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lang/cpp/表达式和函数/异常处理">异常处理</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active">面向对象</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lang/cpp/面向对象/类和对象">类和对象</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lang/cpp/面向对象/设计模式">设计模式</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lang/cpp/面向对象/创建型模式">创建型模式</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/lang/cpp/面向对象/结构型模式">结构型模式</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lang/cpp/面向对象/行为型模式">行为型模式</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">模板和泛型</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lang/cpp/模板和泛型/模板">模板</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lang/cpp/模板和泛型/概念和泛型编程">概念和泛型 编程</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/lang/cpp/io">IO</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lang/cpp/io/stream">流</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lang/cpp/io/文件系统">文件系统</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lang/cpp/io/网络">网络</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">标准库和STL</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lang/cpp/标准库和STL/string">string</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lang/cpp/标准库和STL/容器">容器</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lang/cpp/标准库和STL/标准库">标准库</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lang/cpp/标准库和STL/array">array</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lang/cpp/标准库和STL/vector">vector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lang/cpp/标准库和STL/迭代器">迭代器</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lang/cpp/标准库和STL/list">list</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lang/cpp/标准库和STL/stack">stack</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lang/cpp/标准库和STL/算法">算法</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lang/cpp/标准库和STL/queue">queue</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lang/cpp/标准库和STL/仿函数">仿函数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lang/cpp/标准库和STL/deque">deque</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lang/cpp/标准库和STL/priority_queue">priority_queue</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lang/cpp/标准库和STL/map">map</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lang/cpp/标准库和STL/set">set</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_z5aJ"><div class="docItemContainer_c0TR"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">面向对象</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">结构型模式</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><h1>结构型模式</h1>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="适配器模式">适配器模式<a href="#适配器模式" class="hash-link" aria-label="适配器模式的直接链接" title="适配器模式的直接链接">​</a></h2>
<p>Adapter 将一个类的接口转换成客户希望的另外一个接口，使得原本由于接口不兼容而不能一起工作的那些类能一起工作。</p>
<p>优点
客户端通过适配器可以透明地调用目标接口。
复用了现存的类，程序员不需要修改原有代码而重用现有的适配者类。
将目标类和适配者类解耦，解决了目标类和适配者类接口不一致的问题。
缺点
对类适配器来说，更换适配器的实现过程比较复杂。
应用场景</p>
<p>在现实生活中，经常出现两个对象因接口不兼容而不能在一起  工作的实例，这时需要第三者进行适配。例如，讲中文的人同讲英文的人对话时需要一个翻译，用直流电的笔记本电脑接交流电源时需要一个电源适配器，用计算机访问照相机的 SD 内存卡时需要一个读卡器等。
在软件设计中也可能出现：需要开发的具有某种业务功能的组件在现有的组件库中已经存在，但它们与当前系统的接口规范不兼容，如果重新开发这些组件成本又很高，这时用适配器模式能很好地解决这些问题。</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * 目标定义了客户端代码使用的领域特定接口。</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">class</span><span class="token plain"> </span><span class="token class-name" style="color:#008080">Target</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">public</span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">virtual</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">~</span><span class="token function" style="color:#00627A">Target</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">default</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">virtual</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string </span><span class="token function" style="color:#00627A">Request</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#0033B3">return</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;Target: The default target&#x27;s behavior.&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * 适配器包含一些有用的行为，但其接口与现有的客户端代码不兼容。适配器需要在客户端代码可以使用它之前进行一些适应。</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">class</span><span class="token plain"> </span><span class="token class-name" style="color:#008080">Adaptee</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">public</span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string </span><span class="token function" style="color:#00627A">SpecificRequest</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#0033B3">return</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;.eetpadA eht fo roivaheb laicepS&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * 适配器使适配器的接口与目标的接口兼容。</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">class</span><span class="token plain"> </span><span class="token class-name" style="color:#008080">Adapter</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#0033B3">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#008080">Target</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">private</span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Adaptee </span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">adaptee_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">public</span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#00627A">Adapter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Adaptee </span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">adaptee</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"> </span><span class="token function" style="color:#00627A">adaptee_</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">adaptee</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string </span><span class="token function" style="color:#00627A">Request</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">override</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string to_reverse </span><span class="token operator" style="color:rgb(216, 60, 8)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">this</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token plain">adaptee_</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token function" style="color:#00627A">SpecificRequest</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#00627A">reverse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">to_reverse</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#00627A">begin</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> to_reverse</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#00627A">end</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#0033B3">return</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;Adapter: (TRANSLATED) &quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">+</span><span class="token plain"> to_reverse</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * The client code supports all classes that follow the Target interface.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">void</span><span class="token plain"> </span><span class="token function" style="color:#00627A">ClientCode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> Target </span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">target</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> target</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token function" style="color:#00627A">Request</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">int</span><span class="token plain"> </span><span class="token function" style="color:#00627A">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;Client: 默认的对象工作很好：\n&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Target </span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">target </span><span class="token operator" style="color:rgb(216, 60, 8)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">new</span><span class="token plain"> Target</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#00627A">ClientCode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">target</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;\n\n&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Adaptee </span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">adaptee </span><span class="token operator" style="color:rgb(216, 60, 8)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">new</span><span class="token plain"> Adaptee</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;Client: The Adaptee class has a weird interface. See, I don&#x27;t understand it:\n&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;Adaptee: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> adaptee</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token function" style="color:#00627A">SpecificRequest</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;\n\n&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;Client: But I can work with it via the Adapter:\n&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Adapter </span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">adapter </span><span class="token operator" style="color:rgb(216, 60, 8)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">new</span><span class="token plain"> </span><span class="token function" style="color:#00627A">Adapter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">adaptee</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#00627A">ClientCode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">adapter</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">delete</span><span class="token plain"> target</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">delete</span><span class="token plain"> adaptee</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">delete</span><span class="token plain"> adapter</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">return</span><span class="token plain"> </span><span class="token number" style="color:#1750EB">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">output</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Client: I can work just fine with the Target objects:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Target: The default target&#x27;s behavior.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Client: The Adaptee class has a weird interface. See, I don&#x27;t understand it:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Adaptee: .eetpadA eht fo roivaheb laicepS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Client: But I can work with it via the Adapter:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Adapter: (TRANSLATED) Special behavior of the Adaptee.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="桥接模式">桥接模式<a href="#桥接模式" class="hash-link" aria-label="桥接模式的直接链接" title="桥接模式的直接链接">​</a></h2>
<p>Bridge 将抽象与实现分离，使它们可以独立变化。它是用组合关系代替继承关系来实现，从而降低了抽象和实现这两个可变维度的耦合度。</p>
<p>优点
由于抽象与实现分离，所以扩展能力强；
其实现细节对客户透明。
缺点
要求开发者针对抽象化进行设计与编程
应用场景</p>
<p>在现实生活中，某些类具有两个或多个维度的变化，如图形既可按形状分，又可按颜色分。如何设计类似于 Photoshop 这样的软件，能画不同形状和不同颜色的图形呢？如果用继承方式，m 种形状和 n 种颜色的图形就有 m×n 种，不但对应的子类很多，而且扩展困难。
这样的例子还有很多，如不同颜色和字体的文字、不同品牌和功率的汽车、不同性别和职业的男女、支持不同平台和不同文件格式的媒体播放器等。</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * 实现定义了所有实现类的接口。它不必与抽象的接口匹配。事实上，这两个接口可以完全不同。通常，实现接口仅提供原始操作，而抽象根据这些原始操作定义更高级别的操作。</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">class</span><span class="token plain"> </span><span class="token class-name" style="color:#008080">Implementation</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">public</span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">virtual</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">~</span><span class="token function" style="color:#00627A">Implementation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">virtual</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string </span><span class="token function" style="color:#00627A">OperationImplementation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">=</span><span class="token plain"> </span><span class="token number" style="color:#1750EB">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * Each Concrete Implementation corresponds to a specific platform and</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * implements the Implementation interface using that platform&#x27;s API.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">class</span><span class="token plain"> </span><span class="token class-name" style="color:#008080">ConcreteImplementationA</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#0033B3">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#008080">Implementation</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">public</span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string </span><span class="token function" style="color:#00627A">OperationImplementation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">override</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#0033B3">return</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;ConcreteImplementationA: Here&#x27;s the result on the platform A.\n&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">class</span><span class="token plain"> </span><span class="token class-name" style="color:#008080">ConcreteImplementationB</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#0033B3">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#008080">Implementation</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">public</span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string </span><span class="token function" style="color:#00627A">OperationImplementation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">override</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#0033B3">return</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;ConcreteImplementationB: Here&#x27;s the result on the platform B.\n&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * The Abstraction defines the interface for the &quot;control&quot; part of the two class</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * hierarchies. It maintains a reference to an object of the Implementation</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * hierarchy and delegates all of the real work to this object.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">class</span><span class="token plain"> </span><span class="token class-name" style="color:#008080">Abstraction</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * @var Implementation</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">protected</span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Implementation</span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain"> implementation_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">public</span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#00627A">Abstraction</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Implementation</span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain"> implementation</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"> </span><span class="token function" style="color:#00627A">implementation_</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">implementation</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">virtual</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">~</span><span class="token function" style="color:#00627A">Abstraction</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">virtual</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string </span><span class="token function" style="color:#00627A">Operation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#0033B3">return</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;Abstraction: Base operation with:\n&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           </span><span class="token keyword" style="color:#0033B3">this</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token plain">implementation_</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token function" style="color:#00627A">OperationImplementation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * You can extend the Abstraction without changing the Implementation classes.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">class</span><span class="token plain"> </span><span class="token class-name" style="color:#008080">ExtendedAbstraction</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#0033B3">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#008080">Abstraction</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">public</span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#00627A">ExtendedAbstraction</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Implementation</span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain"> implementation</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"> </span><span class="token function" style="color:#00627A">Abstraction</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">implementation</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string </span><span class="token function" style="color:#00627A">Operation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">override</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#0033B3">return</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;ExtendedAbstraction: Extended operation with:\n&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           </span><span class="token keyword" style="color:#0033B3">this</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token plain">implementation_</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token function" style="color:#00627A">OperationImplementation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * Except for the initialization phase, where an Abstraction object gets linked</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * with a specific Implementation object, the client code should only depend on</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * the Abstraction class. This way the client code can support any abstraction-</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * implementation combination.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">void</span><span class="token plain"> </span><span class="token function" style="color:#00627A">ClientCode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> Abstraction</span><span class="token operator" style="color:rgb(216, 60, 8)">&amp;</span><span class="token plain"> abstraction</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#8C8C8C;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> abstraction</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#00627A">Operation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#8C8C8C;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * The client code should be able to work with any pre-configured abstraction-</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * implementation combination.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">int</span><span class="token plain"> </span><span class="token function" style="color:#00627A">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Implementation</span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain"> implementation </span><span class="token operator" style="color:rgb(216, 60, 8)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">new</span><span class="token plain"> ConcreteImplementationA</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Abstraction</span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain"> abstraction </span><span class="token operator" style="color:rgb(216, 60, 8)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">new</span><span class="token plain"> </span><span class="token function" style="color:#00627A">Abstraction</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">implementation</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#00627A">ClientCode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">abstraction</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">endl</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">delete</span><span class="token plain"> implementation</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">delete</span><span class="token plain"> abstraction</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  implementation </span><span class="token operator" style="color:rgb(216, 60, 8)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">new</span><span class="token plain"> ConcreteImplementationB</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  abstraction </span><span class="token operator" style="color:rgb(216, 60, 8)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">new</span><span class="token plain"> </span><span class="token function" style="color:#00627A">ExtendedAbstraction</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">implementation</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#00627A">ClientCode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">abstraction</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">delete</span><span class="token plain"> implementation</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">delete</span><span class="token plain"> abstraction</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">return</span><span class="token plain"> </span><span class="token number" style="color:#1750EB">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">output</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Abstraction: Base operation with:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ConcreteImplementationA: Here&#x27;s the result on the platform A.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ExtendedAbstraction: Extended operation with:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ConcreteImplementationB: Here&#x27;s the result on the platform B.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="装饰模式">装饰模式<a href="#装 饰模式" class="hash-link" aria-label="装饰模式的直接链接" title="装饰模式的直接链接">​</a></h2>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * The base Component interface defines operations that can be altered by</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * decorators.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">class</span><span class="token plain"> </span><span class="token class-name" style="color:#008080">Component</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">public</span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">virtual</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">~</span><span class="token function" style="color:#00627A">Component</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">virtual</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string </span><span class="token function" style="color:#00627A">Operation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">=</span><span class="token plain"> </span><span class="token number" style="color:#1750EB">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * Concrete Components provide default implementations of the operations. There</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * might be several variations of these classes.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">class</span><span class="token plain"> </span><span class="token class-name" style="color:#008080">ConcreteComponent</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#0033B3">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#008080">Component</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">public</span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string </span><span class="token function" style="color:#00627A">Operation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">override</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#0033B3">return</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;ConcreteComponent&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * The base Decorator class follows the same interface as the other components.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * The primary purpose of this class is to define the wrapping interface for all</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * concrete decorators. The default implementation of the wrapping code might</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * include a field for storing a wrapped component and the means to initialize</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * it.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">class</span><span class="token plain"> </span><span class="token class-name" style="color:#008080">Decorator</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#0033B3">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#008080">Component</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * @var Component</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">protected</span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Component</span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain"> component_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">public</span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#00627A">Decorator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Component</span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain"> component</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"> </span><span class="token function" style="color:#00627A">component_</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">component</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * The Decorator delegates all work to the wrapped component.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string </span><span class="token function" style="color:#00627A">Operation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">override</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#0033B3">return</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">this</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token plain">component_</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token function" style="color:#00627A">Operation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * Concrete Decorators call the wrapped object and alter its result in some way.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">class</span><span class="token plain"> </span><span class="token class-name" style="color:#008080">ConcreteDecoratorA</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#0033B3">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#008080">Decorator</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * Decorators may call parent implementation of the operation, instead of</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * calling the wrapped object directly. This approach simplifies extension of</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * decorator classes.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">public</span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#00627A">ConcreteDecoratorA</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Component</span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain"> component</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"> </span><span class="token function" style="color:#00627A">Decorator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">component</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string </span><span class="token function" style="color:#00627A">Operation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">override</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#0033B3">return</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;ConcreteDecoratorA(&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">+</span><span class="token plain"> </span><span class="token class-name" style="color:#008080">Decorator</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#00627A">Operation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">+</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;)&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * Decorators can execute their behavior either before or after the call to a</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * wrapped object.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">class</span><span class="token plain"> </span><span class="token class-name" style="color:#008080">ConcreteDecoratorB</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#0033B3">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#008080">Decorator</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">public</span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#00627A">ConcreteDecoratorB</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Component</span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain"> component</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"> </span><span class="token function" style="color:#00627A">Decorator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">component</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string </span><span class="token function" style="color:#00627A">Operation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">override</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#0033B3">return</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;ConcreteDecoratorB(&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">+</span><span class="token plain"> </span><span class="token class-name" style="color:#008080">Decorator</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#00627A">Operation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">+</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;)&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * The client code works with all objects using the Component interface. This</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * way it can stay independent of the concrete classes of components it works</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * with.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">void</span><span class="token plain"> </span><span class="token function" style="color:#00627A">ClientCode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Component</span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain"> component</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#8C8C8C;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;RESULT: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> component</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token function" style="color:#00627A">Operation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#8C8C8C;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">int</span><span class="token plain"> </span><span class="token function" style="color:#00627A">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * This way the client code can support both simple components...</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Component</span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain"> simple </span><span class="token operator" style="color:rgb(216, 60, 8)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">new</span><span class="token plain"> ConcreteComponent</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;Client: I&#x27;ve got a simple component:\n&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#00627A">ClientCode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">simple</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;\n\n&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * ...as well as decorated ones.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   *</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * Note how decorators can wrap not only simple components but the other</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * decorators as well.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Component</span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain"> decorator1 </span><span class="token operator" style="color:rgb(216, 60, 8)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">new</span><span class="token plain"> </span><span class="token function" style="color:#00627A">ConcreteDecoratorA</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">simple</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Component</span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain"> decorator2 </span><span class="token operator" style="color:rgb(216, 60, 8)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">new</span><span class="token plain"> </span><span class="token function" style="color:#00627A">ConcreteDecoratorB</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">decorator1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;Client: Now I&#x27;ve got a decorated component:\n&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#00627A">ClientCode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">decorator2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;\n&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">delete</span><span class="token plain"> simple</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">delete</span><span class="token plain"> decorator1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">delete</span><span class="token plain"> decorator2</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">return</span><span class="token plain"> </span><span class="token number" style="color:#1750EB">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">output</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Client: I&#x27;ve got a simple component:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RESULT: ConcreteComponent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Client: Now I&#x27;ve got a decorated component:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RESULT: ConcreteDecoratorB(ConcreteDecoratorA(ConcreteComponent))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="组合模式">组合模式<a href="#组合模式" class="hash-link" aria-label="组合模式的直接链接" title="组合模式的直接链接">​</a></h2>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#1750EB">#</span><span class="token macro property directive keyword" style="color:#0033B3">include</span><span class="token macro property" style="color:#1750EB"> </span><span class="token macro property string" style="color:#067D17">&lt;algorithm&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#1750EB">#</span><span class="token macro property directive keyword" style="color:#0033B3">include</span><span class="token macro property" style="color:#1750EB"> </span><span class="token macro property string" style="color:#067D17">&lt;iostream&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#1750EB">#</span><span class="token macro property directive keyword" style="color:#0033B3">include</span><span class="token macro property" style="color:#1750EB"> </span><span class="token macro property string" style="color:#067D17">&lt;list&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#1750EB">#</span><span class="token macro property directive keyword" style="color:#0033B3">include</span><span class="token macro property" style="color:#1750EB"> </span><span class="token macro property string" style="color:#067D17">&lt;string&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * The base Component class declares common operations for both simple and</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * complex objects of a composition.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">class</span><span class="token plain"> </span><span class="token class-name" style="color:#008080">Component</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * @var Component</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">protected</span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Component </span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">parent_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * Optionally, the base Component can declare an interface for setting and</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * accessing a parent of the component in a tree structure. It can also</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * provide some default implementation for these methods.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">public</span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">virtual</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">~</span><span class="token function" style="color:#00627A">Component</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">void</span><span class="token plain"> </span><span class="token function" style="color:#00627A">SetParent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Component </span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">parent</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#0033B3">this</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token plain">parent_ </span><span class="token operator" style="color:rgb(216, 60, 8)">=</span><span class="token plain"> parent</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Component </span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token function" style="color:#00627A">GetParent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#0033B3">return</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">this</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token plain">parent_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * In some cases, it would be beneficial to define the child-management</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * operations right in the base Component class. This way, you won&#x27;t need to</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * expose any concrete component classes to the client code, even during the</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * object tree assembly. The downside is that these methods will be empty for</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * the leaf-level components.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">virtual</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">void</span><span class="token plain"> </span><span class="token function" style="color:#00627A">Add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Component </span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">component</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">virtual</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">void</span><span class="token plain"> </span><span class="token function" style="color:#00627A">Remove</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Component </span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">component</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * You can provide a method that lets the client code figure out whether a</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * component can bear children.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">virtual</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">bool</span><span class="token plain"> </span><span class="token function" style="color:#00627A">IsComposite</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#0033B3">return</span><span class="token plain"> </span><span class="token boolean" style="color:#1750EB">false</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * The base Component may implement some default behavior or leave it to</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * concrete classes (by declaring the method containing the behavior as</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * &quot;abstract&quot;).</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">virtual</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string </span><span class="token function" style="color:#00627A">Operation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">=</span><span class="token plain"> </span><span class="token number" style="color:#1750EB">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * The Leaf class represents the end objects of a composition. A leaf can&#x27;t have</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * any children.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * Usually, it&#x27;s the Leaf objects that do the actual work, whereas Composite</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * objects only delegate to their sub-components.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">class</span><span class="token plain"> </span><span class="token class-name" style="color:#008080">Leaf</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#0033B3">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#008080">Component</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">public</span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string </span><span class="token function" style="color:#00627A">Operation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">override</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#0033B3">return</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;Leaf&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * The Composite class represents the complex components that may have children.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * Usually, the Composite objects delegate the actual work to their children and</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * then &quot;sum-up&quot; the result.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">class</span><span class="token plain"> </span><span class="token class-name" style="color:#008080">Composite</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#0033B3">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#008080">Component</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * @var \SplObjectStorage</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">protected</span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">list</span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;</span><span class="token plain">Component </span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token operator" style="color:rgb(216, 60, 8)">&gt;</span><span class="token plain"> children_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">public</span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * A composite object can add or remove other components (both simple or</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * complex) to or from its child list.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">void</span><span class="token plain"> </span><span class="token function" style="color:#00627A">Add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Component </span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">component</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">override</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#0033B3">this</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token plain">children_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#00627A">push_back</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">component</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    component</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token function" style="color:#00627A">SetParent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#0033B3">this</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * Have in mind that this method removes the pointer to the list but doesn&#x27;t</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * frees the</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   *     memory, you should do it manually or better use smart pointers.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">void</span><span class="token plain"> </span><span class="token function" style="color:#00627A">Remove</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Component </span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">component</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">override</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    children_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#00627A">remove</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">component</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    component</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token function" style="color:#00627A">SetParent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#0033B3">nullptr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">bool</span><span class="token plain"> </span><span class="token function" style="color:#00627A">IsComposite</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">override</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#0033B3">return</span><span class="token plain"> </span><span class="token boolean" style="color:#1750EB">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * The Composite executes its primary logic in a particular way. It traverses</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * recursively through all its children, collecting and summing their results.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * Since the composite&#x27;s children pass these calls to their children and so</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * forth, the whole object tree is traversed as a result.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string </span><span class="token function" style="color:#00627A">Operation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">override</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string result</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#0033B3">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> Component </span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">c </span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"> children_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#0033B3">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">c </span><span class="token operator" style="color:rgb(216, 60, 8)">==</span><span class="token plain"> children_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#00627A">back</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        result </span><span class="token operator" style="color:rgb(216, 60, 8)">+=</span><span class="token plain"> c</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token function" style="color:#00627A">Operation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        result </span><span class="token operator" style="color:rgb(216, 60, 8)">+=</span><span class="token plain"> c</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token function" style="color:#00627A">Operation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">+</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;+&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#0033B3">return</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;Branch(&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">+</span><span class="token plain"> result </span><span class="token operator" style="color:rgb(216, 60, 8)">+</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;)&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * The client code works with all of the components via the base interface.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">void</span><span class="token plain"> </span><span class="token function" style="color:#00627A">ClientCode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Component </span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">component</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#8C8C8C;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;RESULT: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> component</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token function" style="color:#00627A">Operation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#8C8C8C;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * Thanks to the fact that the child-management operations are declared in the</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * base Component class, the client code can work with any component, simple or</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * complex, without depending on their concrete classes.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">void</span><span class="token plain"> </span><span class="token function" style="color:#00627A">ClientCode2</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Component </span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">component1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Component </span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">component2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#8C8C8C;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">component1</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token function" style="color:#00627A">IsComposite</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    component1</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token function" style="color:#00627A">Add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">component2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;RESULT: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> component1</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token function" style="color:#00627A">Operation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#8C8C8C;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * This way the client code can support the simple leaf components...</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">int</span><span class="token plain"> </span><span class="token function" style="color:#00627A">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Component </span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">simple </span><span class="token operator" style="color:rgb(216, 60, 8)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">new</span><span class="token plain"> Leaf</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;Client: I&#x27;ve got a simple component:\n&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#00627A">ClientCode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">simple</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;\n\n&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * ...as well as the complex composites.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Component </span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">tree </span><span class="token operator" style="color:rgb(216, 60, 8)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">new</span><span class="token plain"> Composite</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Component </span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">branch1 </span><span class="token operator" style="color:rgb(216, 60, 8)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">new</span><span class="token plain"> Composite</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Component </span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">leaf_1 </span><span class="token operator" style="color:rgb(216, 60, 8)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">new</span><span class="token plain"> Leaf</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Component </span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">leaf_2 </span><span class="token operator" style="color:rgb(216, 60, 8)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">new</span><span class="token plain"> Leaf</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Component </span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">leaf_3 </span><span class="token operator" style="color:rgb(216, 60, 8)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">new</span><span class="token plain"> Leaf</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  branch1</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token function" style="color:#00627A">Add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">leaf_1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  branch1</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token function" style="color:#00627A">Add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">leaf_2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Component </span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">branch2 </span><span class="token operator" style="color:rgb(216, 60, 8)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">new</span><span class="token plain"> Composite</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  branch2</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token function" style="color:#00627A">Add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">leaf_3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  tree</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token function" style="color:#00627A">Add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">branch1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  tree</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token function" style="color:#00627A">Add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">branch2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;Client: Now I&#x27;ve got a composite tree:\n&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#00627A">ClientCode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tree</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;\n\n&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;Client: I don&#x27;t need to check the components classes even when managing the tree:\n&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#00627A">ClientCode2</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tree</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> simple</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;\n&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">delete</span><span class="token plain"> simple</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">delete</span><span class="token plain"> tree</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">delete</span><span class="token plain"> branch1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">delete</span><span class="token plain"> branch2</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">delete</span><span class="token plain"> leaf_1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">delete</span><span class="token plain"> leaf_2</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">delete</span><span class="token plain"> leaf_3</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">return</span><span class="token plain"> </span><span class="token number" style="color:#1750EB">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">output</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Client: I&#x27;ve got a simple component:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RESULT: Leaf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Client: Now I&#x27;ve got a composite tree:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RESULT: Branch(Branch(Leaf+Leaf)+Branch(Leaf))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Client: I don&#x27;t need to check the components classes even when managing the tree:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RESULT: Branch(Branch(Leaf+Leaf)+Branch(Leaf)+Leaf)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="外观模式">外观模式<a href="#外观模式" class="hash-link" aria-label="外观模式的直接链接" title="外观模式的直接链接">​</a></h2>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * The Subsystem can accept requests either from the facade or client directly.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * In any case, to the Subsystem, the Facade is yet another client, and it&#x27;s not</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * a part of the Subsystem.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">class</span><span class="token plain"> </span><span class="token class-name" style="color:#008080">Subsystem1</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">public</span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string </span><span class="token function" style="color:#00627A">Operation1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#0033B3">return</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;Subsystem1: Ready!\n&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#8C8C8C;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string </span><span class="token function" style="color:#00627A">OperationN</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#0033B3">return</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;Subsystem1: Go!\n&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * Some facades can work with multiple subsystems at the same time.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">class</span><span class="token plain"> </span><span class="token class-name" style="color:#008080">Subsystem2</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">public</span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string </span><span class="token function" style="color:#00627A">Operation1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#0033B3">return</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;Subsystem2: Get ready!\n&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#8C8C8C;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string </span><span class="token function" style="color:#00627A">OperationZ</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#0033B3">return</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;Subsystem2: Fire!\n&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * The Facade class provides a simple interface to the complex logic of one or</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * several subsystems. The Facade delegates the client requests to the</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * appropriate objects within the subsystem. The Facade is also responsible for</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * managing their lifecycle. All of this shields the client from the undesired</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * complexity of the subsystem.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">class</span><span class="token plain"> </span><span class="token class-name" style="color:#008080">Facade</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">protected</span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Subsystem1 </span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">subsystem1_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Subsystem2 </span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">subsystem2_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * Depending on your application&#x27;s needs, you can provide the Facade with</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * existing subsystem objects or force the Facade to create them on its own.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">public</span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * In this case we will delegate the memory ownership to Facade Class</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#00627A">Facade</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Subsystem1 </span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">subsystem1 </span><span class="token operator" style="color:rgb(216, 60, 8)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">nullptr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Subsystem2 </span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">subsystem2 </span><span class="token operator" style="color:rgb(216, 60, 8)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">nullptr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#0033B3">this</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token plain">subsystem1_ </span><span class="token operator" style="color:rgb(216, 60, 8)">=</span><span class="token plain"> subsystem1 </span><span class="token operator" style="color:rgb(216, 60, 8)">?</span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">new</span><span class="token plain"> Subsystem1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#0033B3">this</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token plain">subsystem2_ </span><span class="token operator" style="color:rgb(216, 60, 8)">=</span><span class="token plain"> subsystem2 </span><span class="token operator" style="color:rgb(216, 60, 8)">?</span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">new</span><span class="token plain"> Subsystem2</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:rgb(216, 60, 8)">~</span><span class="token function" style="color:#00627A">Facade</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#0033B3">delete</span><span class="token plain"> subsystem1_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#0033B3">delete</span><span class="token plain"> subsystem2_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * The Facade&#x27;s methods are convenient shortcuts to the sophisticated</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * functionality of the subsystems. However, clients get only to a fraction of</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * a subsystem&#x27;s capabilities.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string </span><span class="token function" style="color:#00627A">Operation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string result </span><span class="token operator" style="color:rgb(216, 60, 8)">=</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;Facade initializes subsystems:\n&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    result </span><span class="token operator" style="color:rgb(216, 60, 8)">+=</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">this</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token plain">subsystem1_</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token function" style="color:#00627A">Operation1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    result </span><span class="token operator" style="color:rgb(216, 60, 8)">+=</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">this</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token plain">subsystem2_</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token function" style="color:#00627A">Operation1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    result </span><span class="token operator" style="color:rgb(216, 60, 8)">+=</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;Facade orders subsystems to perform the action:\n&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    result </span><span class="token operator" style="color:rgb(216, 60, 8)">+=</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">this</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token plain">subsystem1_</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token function" style="color:#00627A">OperationN</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    result </span><span class="token operator" style="color:rgb(216, 60, 8)">+=</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">this</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token plain">subsystem2_</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token function" style="color:#00627A">OperationZ</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#0033B3">return</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * The client code works with complex subsystems through a simple interface</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * provided by the Facade. When a facade manages the lifecycle of the subsystem,</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * the client might not even know about the existence of the subsystem. This</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * approach lets you keep the complexity under control.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">void</span><span class="token plain"> </span><span class="token function" style="color:#00627A">ClientCode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Facade </span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">facade</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#8C8C8C;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> facade</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token function" style="color:#00627A">Operation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#8C8C8C;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * The client code may have some of the subsystem&#x27;s objects already created. In</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * this case, it might be worthwhile to initialize the Facade with these objects</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * instead of letting the Facade create new instances.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">int</span><span class="token plain"> </span><span class="token function" style="color:#00627A">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Subsystem1 </span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">subsystem1 </span><span class="token operator" style="color:rgb(216, 60, 8)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">new</span><span class="token plain"> Subsystem1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Subsystem2 </span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">subsystem2 </span><span class="token operator" style="color:rgb(216, 60, 8)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">new</span><span class="token plain"> Subsystem2</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Facade </span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">facade </span><span class="token operator" style="color:rgb(216, 60, 8)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">new</span><span class="token plain"> </span><span class="token function" style="color:#00627A">Facade</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">subsystem1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> subsystem2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#00627A">ClientCode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">facade</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">delete</span><span class="token plain"> facade</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">return</span><span class="token plain"> </span><span class="token number" style="color:#1750EB">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">output</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Facade initializes subsystems:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Subsystem1: Ready!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Subsystem2: Get ready!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Facade orders subsystems to perform the action:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Subsystem1: Go!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Subsystem2: Fire!</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="享元模式">享元模式<a href="#享元模式" class="hash-link" aria-label="享元模式的直接链接" title="享元模式的直接链接">​</a></h2>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * Flyweight Design Pattern</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * Intent: Lets you fit more objects into the available amount of RAM by sharing</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * common parts of state between multiple objects, instead of keeping all of the</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * data in each object.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">struct</span><span class="token plain"> </span><span class="token class-name" style="color:#008080">SharedState</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string brand_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string model_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string color_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#00627A">SharedState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string </span><span class="token operator" style="color:rgb(216, 60, 8)">&amp;</span><span class="token plain">brand</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string </span><span class="token operator" style="color:rgb(216, 60, 8)">&amp;</span><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string </span><span class="token operator" style="color:rgb(216, 60, 8)">&amp;</span><span class="token plain">color</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"> </span><span class="token function" style="color:#00627A">brand_</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">brand</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#00627A">model_</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#00627A">color_</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">color</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#0033B3">friend</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ostream </span><span class="token operator" style="color:rgb(216, 60, 8)">&amp;</span><span class="token keyword" style="color:#0033B3">operator</span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ostream </span><span class="token operator" style="color:rgb(216, 60, 8)">&amp;</span><span class="token plain">os</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> SharedState </span><span class="token operator" style="color:rgb(216, 60, 8)">&amp;</span><span class="token plain">ss</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#0033B3">return</span><span class="token plain"> os </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;[ &quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> ss</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">brand_ </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot; , &quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> ss</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">model_ </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot; , &quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> ss</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">color_ </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot; ]&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">struct</span><span class="token plain"> </span><span class="token class-name" style="color:#008080">UniqueState</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string owner_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string plates_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#00627A">UniqueState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string </span><span class="token operator" style="color:rgb(216, 60, 8)">&amp;</span><span class="token plain">owner</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string </span><span class="token operator" style="color:rgb(216, 60, 8)">&amp;</span><span class="token plain">plates</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"> </span><span class="token function" style="color:#00627A">owner_</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">owner</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#00627A">plates_</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">plates</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#0033B3">friend</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ostream </span><span class="token operator" style="color:rgb(216, 60, 8)">&amp;</span><span class="token keyword" style="color:#0033B3">operator</span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ostream </span><span class="token operator" style="color:rgb(216, 60, 8)">&amp;</span><span class="token plain">os</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> UniqueState </span><span class="token operator" style="color:rgb(216, 60, 8)">&amp;</span><span class="token plain">us</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#0033B3">return</span><span class="token plain"> os </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;[ &quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> us</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">owner_ </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot; , &quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> us</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">plates_ </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot; ]&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * The Flyweight stores a common portion of the state (also called intrinsic</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * state) that belongs to multiple real business entities. The Flyweight accepts</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * the rest of the state (extrinsic state, unique for each entity) via its</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * method parameters.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">class</span><span class="token plain"> </span><span class="token class-name" style="color:#008080">Flyweight</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">private</span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SharedState </span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">shared_state_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">public</span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#00627A">Flyweight</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> SharedState </span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">shared_state</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"> </span><span class="token function" style="color:#00627A">shared_state_</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#0033B3">new</span><span class="token plain"> </span><span class="token function" style="color:#00627A">SharedState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">shared_state</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#00627A">Flyweight</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> Flyweight </span><span class="token operator" style="color:rgb(216, 60, 8)">&amp;</span><span class="token plain">other</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"> </span><span class="token function" style="color:#00627A">shared_state_</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#0033B3">new</span><span class="token plain"> </span><span class="token function" style="color:#00627A">SharedState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">other</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">shared_state_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:rgb(216, 60, 8)">~</span><span class="token function" style="color:#00627A">Flyweight</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#0033B3">delete</span><span class="token plain"> shared_state_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SharedState </span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token function" style="color:#00627A">shared_state</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#0033B3">return</span><span class="token plain"> shared_state_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#0033B3">void</span><span class="token plain"> </span><span class="token function" style="color:#00627A">Operation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> UniqueState </span><span class="token operator" style="color:rgb(216, 60, 8)">&amp;</span><span class="token plain">unique_state</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;Flyweight: Displaying shared (&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">shared_state_ </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;) and unique (&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> unique_state </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;) state.\n&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * The Flyweight Factory creates and manages the Flyweight objects. It ensures</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * that flyweights are shared correctly. When the client requests a flyweight,</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * the factory either returns an existing instance or creates a new one, if it</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * doesn&#x27;t exist yet.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">class</span><span class="token plain"> </span><span class="token class-name" style="color:#008080">FlyweightFactory</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">     * @var Flyweight[]</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">private</span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">unordered_map</span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Flyweight</span><span class="token operator" style="color:rgb(216, 60, 8)">&gt;</span><span class="token plain"> flyweights_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">     * Returns a Flyweight&#x27;s string hash for a given state.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string </span><span class="token function" style="color:#00627A">GetKey</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> SharedState </span><span class="token operator" style="color:rgb(216, 60, 8)">&amp;</span><span class="token plain">ss</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#0033B3">return</span><span class="token plain"> ss</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">brand_ </span><span class="token operator" style="color:rgb(216, 60, 8)">+</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;_&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">+</span><span class="token plain"> ss</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">model_ </span><span class="token operator" style="color:rgb(216, 60, 8)">+</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;_&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">+</span><span class="token plain"> ss</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">color_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">public</span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#00627A">FlyweightFactory</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">initializer_list</span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;</span><span class="token plain">SharedState</span><span class="token operator" style="color:rgb(216, 60, 8)">&gt;</span><span class="token plain"> share_states</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#0033B3">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> SharedState </span><span class="token operator" style="color:rgb(216, 60, 8)">&amp;</span><span class="token plain">ss </span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"> share_states</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#0033B3">this</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token plain">flyweights_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#00627A">insert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function function" style="color:#00627A">make_pair</span><span class="token generic-function generic class-name operator" style="color:rgb(216, 60, 8)">&lt;</span><span class="token generic-function generic class-name" style="color:#008080">std</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#008080">string</span><span class="token generic-function generic class-name punctuation" style="color:#393A34">,</span><span class="token generic-function generic class-name" style="color:#008080"> Flyweight</span><span class="token generic-function generic class-name operator" style="color:rgb(216, 60, 8)">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#0033B3">this</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token function" style="color:#00627A">GetKey</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ss</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#00627A">Flyweight</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:rgb(216, 60, 8)">&amp;</span><span class="token plain">ss</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">     * Returns an existing Flyweight with a given state or creates a new one.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Flyweight </span><span class="token function" style="color:#00627A">GetFlyweight</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> SharedState </span><span class="token operator" style="color:rgb(216, 60, 8)">&amp;</span><span class="token plain">shared_state</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string key </span><span class="token operator" style="color:rgb(216, 60, 8)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">this</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token function" style="color:#00627A">GetKey</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">shared_state</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#0033B3">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#0033B3">this</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token plain">flyweights_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#00627A">find</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">==</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">this</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token plain">flyweights_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#00627A">end</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;FlyweightFactory: Can&#x27;t find a flyweight, creating new one.\n&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#0033B3">this</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token plain">flyweights_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#00627A">insert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#00627A">make_pair</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#00627A">Flyweight</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:rgb(216, 60, 8)">&amp;</span><span class="token plain">shared_state</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#0033B3">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;FlyweightFactory: Reusing existing flyweight.\n&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#0033B3">return</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">this</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token plain">flyweights_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#00627A">at</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#0033B3">void</span><span class="token plain"> </span><span class="token function" style="color:#00627A">ListFlyweights</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        size_t count </span><span class="token operator" style="color:rgb(216, 60, 8)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">this</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token plain">flyweights_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#00627A">size</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;\nFlyweightFactory: I have &quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> count </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot; flyweights:\n&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#0033B3">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">pair</span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Flyweight</span><span class="token operator" style="color:rgb(216, 60, 8)">&gt;</span><span class="token plain"> pair </span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">this</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token plain">flyweights_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> pair</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">first </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;\n&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#8C8C8C;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">void</span><span class="token plain"> </span><span class="token function" style="color:#00627A">AddCarToPoliceDatabase</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FlyweightFactory </span><span class="token operator" style="color:rgb(216, 60, 8)">&amp;</span><span class="token plain">ff</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string </span><span class="token operator" style="color:rgb(216, 60, 8)">&amp;</span><span class="token plain">plates</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string </span><span class="token operator" style="color:rgb(216, 60, 8)">&amp;</span><span class="token plain">owner</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string </span><span class="token operator" style="color:rgb(216, 60, 8)">&amp;</span><span class="token plain">brand</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string </span><span class="token operator" style="color:rgb(216, 60, 8)">&amp;</span><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string </span><span class="token operator" style="color:rgb(216, 60, 8)">&amp;</span><span class="token plain">color</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;\nClient: Adding a car to database.\n&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> Flyweight </span><span class="token operator" style="color:rgb(216, 60, 8)">&amp;</span><span class="token plain">flyweight </span><span class="token operator" style="color:rgb(216, 60, 8)">=</span><span class="token plain"> ff</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#00627A">GetFlyweight</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">brand</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> model</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> color</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#8C8C8C;font-style:italic">// The client code either stores or calculates extrinsic state and passes it</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#8C8C8C;font-style:italic">// to the flyweight&#x27;s methods.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    flyweight</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#00627A">Operation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">owner</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> plates</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * The client code usually creates a bunch of pre-populated flyweights in the</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * initialization stage of the application.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">int</span><span class="token plain"> </span><span class="token function" style="color:#00627A">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FlyweightFactory </span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">factory </span><span class="token operator" style="color:rgb(216, 60, 8)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">new</span><span class="token plain"> </span><span class="token function" style="color:#00627A">FlyweightFactory</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#067D17">&quot;Chevrolet&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;Camaro2018&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;pink&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#067D17">&quot;Mercedes Benz&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;C300&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;black&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#067D17">&quot;Mercedes Benz&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;C500&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;red&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#067D17">&quot;BMW&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;M5&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;red&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#067D17">&quot;BMW&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;X6&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;white&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    factory</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token function" style="color:#00627A">ListFlyweights</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#00627A">AddCarToPoliceDatabase</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">factory</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            </span><span class="token string" style="color:#067D17">&quot;CL234IR&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            </span><span class="token string" style="color:#067D17">&quot;James Doe&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            </span><span class="token string" style="color:#067D17">&quot;BMW&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            </span><span class="token string" style="color:#067D17">&quot;M5&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            </span><span class="token string" style="color:#067D17">&quot;red&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#00627A">AddCarToPoliceDatabase</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">factory</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            </span><span class="token string" style="color:#067D17">&quot;CL234IR&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            </span><span class="token string" style="color:#067D17">&quot;James Doe&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            </span><span class="token string" style="color:#067D17">&quot;BMW&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            </span><span class="token string" style="color:#067D17">&quot;X1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            </span><span class="token string" style="color:#067D17">&quot;red&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    factory</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token function" style="color:#00627A">ListFlyweights</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#0033B3">delete</span><span class="token plain"> factory</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#0033B3">return</span><span class="token plain"> </span><span class="token number" style="color:#1750EB">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">output</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">FlyweightFactory: I have 5 flyweights:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BMW_X6_white</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Mercedes Benz_C500_red</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Mercedes Benz_C300_black</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BMW_M5_red</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Chevrolet_Camaro2018_pink</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Client: Adding a car to database.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FlyweightFactory: Reusing existing flyweight.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Flyweight: Displaying shared ([ BMW , M5 , red ]) and unique ([ CL234IR , James Doe ]) state.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Client: Adding a car to database.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FlyweightFactory: Can&#x27;t find a flyweight, creating new one.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Flyweight: Displaying shared ([ BMW , X1 , red ]) and unique ([ CL234IR , James Doe ]) state.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FlyweightFactory: I have 6 flyweights:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BMW_X1_red</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Mercedes Benz_C300_black</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BMW_X6_white</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Mercedes Benz_C500_red</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BMW_M5_red</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Chevrolet_Camaro2018_pink</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="代理模式">代理模式<a href="#代理模式" class="hash-link" aria-label="代理模式的直接链接" title="代理模式的直接链接">​</a></h2>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#1750EB">#</span><span class="token macro property directive keyword" style="color:#0033B3">include</span><span class="token macro property" style="color:#1750EB"> </span><span class="token macro property string" style="color:#067D17">&lt;iostream&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * The Subject interface declares common operations for both RealSubject and the</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * Proxy. As long as the client works with RealSubject using this interface,</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * you&#x27;ll be able to pass it a proxy instead of a real subject.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">class</span><span class="token plain"> </span><span class="token class-name" style="color:#008080">Subject</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">public</span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">virtual</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">void</span><span class="token plain"> </span><span class="token function" style="color:#00627A">Request</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">=</span><span class="token plain"> </span><span class="token number" style="color:#1750EB">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * The RealSubject contains some core business logic. Usually, RealSubjects are</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * capable of doing some useful work which may also be very slow or sensitive -</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * e.g. correcting input data. A Proxy can solve these issues without any</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * changes to the RealSubject&#x27;s code.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">class</span><span class="token plain"> </span><span class="token class-name" style="color:#008080">RealSubject</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#0033B3">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#008080">Subject</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">public</span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">void</span><span class="token plain"> </span><span class="token function" style="color:#00627A">Request</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">override</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;RealSubject: Handling request.\n&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * The Proxy has an interface identical to the RealSubject.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">class</span><span class="token plain"> </span><span class="token class-name" style="color:#008080">Proxy</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#0033B3">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#008080">Subject</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * @var RealSubject</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">private</span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  RealSubject </span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">real_subject_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">bool</span><span class="token plain"> </span><span class="token function" style="color:#00627A">CheckAccess</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#8C8C8C;font-style:italic">// Some real checks should go here.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;Proxy: Checking access prior to firing a real request.\n&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#0033B3">return</span><span class="token plain"> </span><span class="token boolean" style="color:#1750EB">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">void</span><span class="token plain"> </span><span class="token function" style="color:#00627A">LogAccess</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;Proxy: Logging the time of request.\n&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * The Proxy maintains a reference to an object of the RealSubject class. It</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * can be either lazy-loaded or passed to the Proxy by the client.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">public</span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#00627A">Proxy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">RealSubject </span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">real_subject</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(216, 60, 8)">:</span><span class="token plain"> </span><span class="token function" style="color:#00627A">real_subject_</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#0033B3">new</span><span class="token plain"> </span><span class="token function" style="color:#00627A">RealSubject</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">real_subject</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:rgb(216, 60, 8)">~</span><span class="token function" style="color:#00627A">Proxy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#0033B3">delete</span><span class="token plain"> real_subject_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * The most common applications of the Proxy pattern are lazy loading,</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * caching, controlling the access, logging, etc. A Proxy can perform one of</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * these things and then, depending on the result, pass the execution to the</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   * same method in a linked RealSubject object.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">void</span><span class="token plain"> </span><span class="token function" style="color:#00627A">Request</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">override</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#0033B3">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#0033B3">this</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token function" style="color:#00627A">CheckAccess</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#0033B3">this</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token plain">real_subject_</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token function" style="color:#00627A">Request</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#0033B3">this</span><span class="token operator" style="color:rgb(216, 60, 8)">-&gt;</span><span class="token function" style="color:#00627A">LogAccess</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#8C8C8C;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * The client code is supposed to work with all objects (both subjects and</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * proxies) via the Subject interface in order to support both real subjects and</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * proxies. In real life, however, clients mostly work with their real subjects</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * directly. In this case, to implement the pattern more easily, you can extend</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> * your proxy from the real subject&#x27;s class.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#8C8C8C;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">void</span><span class="token plain"> </span><span class="token function" style="color:#00627A">ClientCode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#0033B3">const</span><span class="token plain"> Subject </span><span class="token operator" style="color:rgb(216, 60, 8)">&amp;</span><span class="token plain">subject</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#8C8C8C;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  subject</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#00627A">Request</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#8C8C8C;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#0033B3">int</span><span class="token plain"> </span><span class="token function" style="color:#00627A">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;Client: Executing the client code with a real subject:\n&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  RealSubject </span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">real_subject </span><span class="token operator" style="color:rgb(216, 60, 8)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">new</span><span class="token plain"> RealSubject</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#00627A">ClientCode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">real_subject</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;\n&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(216, 60, 8)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#067D17">&quot;Client: Executing the same client code with a proxy:\n&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Proxy </span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">proxy </span><span class="token operator" style="color:rgb(216, 60, 8)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0033B3">new</span><span class="token plain"> </span><span class="token function" style="color:#00627A">Proxy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">real_subject</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#00627A">ClientCode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:rgb(216, 60, 8)">*</span><span class="token plain">proxy</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">delete</span><span class="token plain"> real_subject</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">delete</span><span class="token plain"> proxy</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#0033B3">return</span><span class="token plain"> </span><span class="token number" style="color:#1750EB">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">output</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Client: Executing the client code with a real subject:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RealSubject: Handling request.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Client: Executing the same client code with a proxy:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Proxy: Checking access prior to firing a real request.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RealSubject: Handling request.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Proxy: Logging the time of request.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/wangenius/wangenius.github.io/tree/master/docs/lang/cpp/面向对象/结构型模式.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/lang/cpp/面向对象/创建型模式"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">创建型模式</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/lang/cpp/面向对象/行为型模式"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">行为型模式</div></a></nav></div><div>Loading Comments...</div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#适配器模式" class="table-of-contents__link toc-highlight">适配器模式</a></li><li><a href="#桥接模式" class="table-of-contents__link toc-highlight">桥接模式</a></li><li><a href="#装饰模式" class="table-of-contents__link toc-highlight">装饰模式</a></li><li><a href="#组合模式" class="table-of-contents__link toc-highlight">组合模式</a></li><li><a href="#外观模式" class="table-of-contents__link toc-highlight">外观模式</a></li><li><a href="#享元模式" class="table-of-contents__link toc-highlight">享元模式</a></li><li><a href="#代理模式" class="table-of-contents__link toc-highlight">代理模式</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">知识库</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/about/致明日的舞">致明日的舞</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/cs/os/概述">操作系统基础</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/dsa/ds/概述">数据结构</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/lang/rust/简介">Rust</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/cs/db/概述">数据库</a></li></ul></div><div class="col footer__col"><div class="footer__title">社区</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://weibo.com/u/6320492937" target="_blank" rel="noopener noreferrer" class="footer__link-item">微博<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://space.bilibili.com/247967944" target="_blank" rel="noopener noreferrer" class="footer__link-item">bilibili<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.zhihu.com/people/wangenius" target="_blank" rel="noopener noreferrer" class="footer__link-item">知乎<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/wangenius" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">更多</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/about/关于我">关于我</a></li><li class="footer__item"><a class="footer__link-item" href="/blog">博客</a></li><li class="footer__item"><a href="https://github.com/wangenius/wangenius.github.io/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">讨论<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/wangenius/wangenius.github.io/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">FAQ<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 吕麓弥章, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>