---
title : 关于进程和线程概念的区别和理解
sidebar_position : 4
slug : 关于进程和线程概念的区别和理解
---
> 自己做了一个模型用于理解

# 关于进程和线程概念的区别和理解

:::info 定义
作业：上小学，成为一个合格的小学毕业生
进程PCB：老师
进程1：语文老师代课，学语文和美术
1. 语文
2. 美术

进程2：数学老师代课，学数学和科学
1. 数学
2. 科学

进程3：另一个数学老师代课，学奥数

进程4：品德老师代课，学品德

操作系统：学校

CPU：你

寄存器资源：黑板

其他上下文：正在的老师不需要上课老师

其他资源：多媒体，书柜，储藏空间等等

os给进程（内核级线程）分配的时间片：课时

os用于上下文切换时的系统开销：课间，比如上一课老师要离开，下一课老师进入，擦黑板等等

进程：同一老师（PCB）任课。进程为多道程序并发执行诞生（你在上小学期间同时学语文，数学，奥数班）。
:::

## 基本概念的解读
提高CPU（你）的利用率：利用CPU（你）空闲（课后玩耍）的时间上奥数班。

进程2（数学）和进程3（奥数）是同步关系。进程3需要进程2的部分结果（基础数学知识）才能执行，否则阻塞。

进程1（语文）和进程2（数学）可能是互斥关系（语文老师上完语文课没有归还多媒体钥匙，下节数学老师就不能使用多媒体，直到语文老师归还）。

进程间切换要换cpu的工作环境（你需要擦黑板，换老师，上厕所）

进程是拥有资源的基本单位（黑板，多媒体等跟随进程（科目）变化而变化）

PCB是进程存在的唯一标识（老师不在就不能上该课）

## 内核级线程：独立的课程

对于同一个进程（同一个老师代课，拿语文老师为例），语文和美术是两个科目，进程（老师）向os（学校）申请了独立的语文课程和美术课程（内核级线程）。

调度：os（学校）内核划分为了若干课时（时间片）用于调度，分配对象是内核级线程（在支持内核级线程的os中，进程不作为调度的具体对象，即进程在os的调度中是看做内核级线程对待的），因此有多个内核级线程的进程获得更多的时间片（比如语文老师进程有5节语文，2节美术，数学老师进程有5节数学，显然，语文老师获得更多的时间片）。

时间开销：使用时间片（课时）作为调度切换的单位，所以内核级线程需要系统开销（课间）的。

多线程共享一个进程资源：多媒体钥匙都在语文老师手里，即美术课也可以用多媒体。

内核级线程的阻塞不会影响其他线程：第一节是语文课，这节语文课并没有把备课内容讲完，但不影响下一节美术课的进度[^1]。

内核线程切换的几种情况：

上下两节课老师没变（第一节语文，第二节美术）：进程没发生切换而线程发生切换，老师不需要换，只需要擦黑板就行。系统开销比进程间切换小。
上下两节课老师变了（第一节语文，第二节数学）：进程间的线程发生切换，老师也要换（比如可能迟到？），所以开销很大
用户级线程
数学老师任课有很多任务，微积分（用户级线程），线代（用户级线程），概率论（用户级线程），计算机（用户级线程）等。[^2] 这些任务在数学老师申请的数学课和科学课（内核级线程）中完成。

用户级线程的阻塞会导致整个（内核级）线程等待：如果数学老师上节数学课有遗留问题没弄完，这节课无法开新内容。

## 硬件线程
KLT和ULT属于软件线程，是在os层级以上的。硬件线程：有两个或多个完整的寄存器集，允许它代表两个或多个进程（内核级线程）执行指令。

牵强的比喻：原来只有一块黑板（上下文寄存器集），变成了教室前和教室后两块，下一节课可以保留上一节课的黑板内容，因此在进程（内核线程）切换的过程中，减少了恢复上下文的操作（擦黑板等）。

## 其他
从上文便能更好的理解软件线程中的三种模型了。

多对一模型：品德老师只讲品德课，品德课（内核级线程）所讲内容包括\{思想道德，法律\}
一对一模型：语文老师讲语文课和美术课。语文课（内核级线程）讲课文（唯一用户级线程），美术课（内核级线程）上画画（唯一用户级线程）
多对多模型：数学老师讲数学课和科学课。数学课（内核级线程）包括\{微积分，线代，概率论\}，科学课（内核级线程）包括\{计算机，生命科学...\}
综上，线程是一个比进程小的执行单元（相对独立的控制流序列，可以单独执行）。单论不加定语的线程，我更愿意理解为是一种相对概念，一个线程之内还可能有多代线程嵌套。

仅供理解，如有问题请指教

[^1]: 当然是理论上，有些老师可能霸占美术课
[^2]: 小学学这些不过分吧