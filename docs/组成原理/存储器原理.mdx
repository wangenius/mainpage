# 数据的存储

1. 小端方式：低位字节的地址小

2. 大端方式：高位字节的地址小

3. 边界对齐方式：32b半字地址是2的整数倍，字地址是4的整数倍，当所存数据不能满足此要求可以填充空白字节。这样保证对齐后，可以使得每次取数据都是一次性取出。

这里对比c语言结构体存储：[C](https://flowus.cn/5c85d572-fba4-4595-86e1-1b521865feea)

# 存储器分类

1. **RAM**：有主存使用的DRAM、`cache`使用的SRAM，`DDR`使用的`SDRAM`。

2. **ROM**：

    3. `MROM`：芯片生产过程中直接写入，任何人不能修改，用于工业控制机或电器

    4. `PROM`：一次性编程的只读存储器，允许用户利用编程器进行一次写入，一旦写入，无法修改。

    5. `EPORM`：可以进行多次改写。编程次数有限，写入时间过长。

    6. `EEPROM`：电可擦除,IC卡

    7. `flash`：U盘。可长期保存信息，也能在线快速擦除重写，且速度较快。

    8. `SSD`：基于闪存，用固态电子存储芯片阵列制成的硬盘，由控制单元和存储单元组成。闪存芯片代替传统的机械驱动器，闪存翻译器扮演磁盘控制器的角色。随机读很快，随机写很慢，且`SSD`会磨损。SSD分为若干块，每块`32-128page`分为若干页，读写单位是页（512B-4kB）。

9. **串行访问存储器**

    10. `DAM`：磁盘光盘 `CD-ROM`

    11. `SAM`：磁带

`ROM`和`RAM`都**支持随机访问**，但`ROM`一但有了信息，不轻易改变，掉电也不消失。两个显著优点：

1. 结构简单，位密度比可读写存储器高；

2. 具有非易失性。

3. 相联存储器是按内容指定方式和地址指定方式结合进行寻址的存储器

4. cache-MM-ES

    5. cache-MM 全透明

    6. **MM-ES 半透明 只对应用程序员是透明的**

# DRAM芯片原理

1. **结构**：存储体（存储矩阵），地址译码器，IO控制电路，`CS`控制信号，`WE`控制信号。

2. 存储体：`meta -> unit (same address)-> body`。地址码相同的多个存储元构成一个存储单元，若干存储单元的集合构成存储体。利用存储元电路上的**栅极电容上的电荷**来存储信息，基本存储元只使用一个晶体管，比SRAM的密度大，功耗低。相同地址的存储元件构成一个编址单位，可以按字、字节编址，线代计算机通常采用字节编址。

3. **刷新**：电荷需要刷新，通常取2ms为刷新周期

4. 

    5. 集中刷新：一个刷新周期内用一段固定的时间，依此对存储器的所有行进行逐一再生。称为死时间，或访存死区。

    6. 分散刷新：分散到每个存取周期中

    7. 异步刷新：又充分利用最大刷新间隔为2ms的特点，具体操作为：在2ms内对128行各刷新一遍。即每隔15.6μs刷新一行(2000μs/128≈15.6μs)，而每行刷新的时间仍为0.5μs。这样，刷新一行只能停止一个存取周期，但对每行来说，刷新间隔时间仍为2ms，而死时间为0.5μs。（相对每一段来说，是集中式刷新，相对整体来说，是分散式刷新）

8. **读写周期：行列地址分两次送。**先送入读写信号`WE`，（读操作要当写数据在数据总线上保持稳定）行地址送到芯片地址引脚，行选通信号`RAS`，列地址送入芯片地址引脚，列选通信号`CAS`。控制总线（读写）指出总线周期的类型和本次输入、输出操作完成的时刻

**地址引脚复用技术：**行地址和列地址通过相同的引脚分先后两次输入，引脚数减少一半。

引脚：地址引脚+数据引脚+片段信号引脚1+读写信号2+（电源和接地线）

引脚复用后，片段信号搞成行选通和列选通2根



## 内存加速

### 双端口

有两组独立的地址线、数据线、读写控制线。多核CPU想要访问一个内存，是不是意味着第一个CPU访问了一次之后，第二个CPU也需要等这么长的恢复时间，它才可以接着进行访问？这个问题如何解决多核CPU，我们可以用双端口`RAM`这种方式来解决。CPU和IO设备同时访问主存也适用。

### 多模块

**空间并行技术，利用多个结构完全相同的存储模块的并行工作来提高存储器的吞吐率，**常用的有单体多字存储器和多体低位交叉存储器。单体多字和高位交叉模块内的地址是连续的，存取方式是串行存取，因此这种存储器仍然是顺序存储。

1. **单体多字存储器：**存储字长= n×机器字长。一个存储器，每个存储单元存储m个字，总线宽度也是m个字。一次并行读出m个字，地址必须顺序排列并处于同一存储单元中。

2. **多体并行存储器：**高位交叉编址是顺序存储，高位是存储体号，低位是体内地址，不能并行访问，不能提高存储器的吞吐率。

3. **低位交叉编址（计算）**

4. 有m个存储体，低位模m交叉编址，各个模块有独立的读写控制电路、地址寄存器和数据寄存器

5. **假设模块字长=数据总线宽度，模块存取一个字的存取周期是T，总线传输周期是r，**在不改变模块存取周期的前提下，**为了实现流水线方式存取**，提高存储器的带宽**，存储器交叉模块数应该大于等于m = T/r**

6. 交叉存储器要求其模块数必须大于等于m，以保证某模块在经过m×r的时间后在此启动该模块时，其上此的存取操作已经完成（流水线不间断）

7. 满足局部性原理

## 容量扩展

1. 位扩展：`chip`连接`abus`的方式相同，连接`dbus`的方式不同。片选信号连接所有`chip`，扩展到编址单位

2. 字扩展：`chip`连接`abus`和`dbus`的方式相同，片选信号或译码器连接相应的芯片

片选信号：

1. 线选法：某地址线信息=0，选中对应的存储芯片

2. 译码片选法：译码器

# SRAM芯片原理

制造SRAM需要更多的硅。存储元是6晶体管MOS双稳态触发器，不需要再生，非破坏性读出。

行列地址一次送，默认两个读写线路，cache使用。



